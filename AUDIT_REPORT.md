# AI Debate プロジェクト 監査レポート

## 🔍 不正確な情報・修正が必要な項目リスト

### **高優先度 (Critical)**

#### 1. **homepage.tsx**
- **問題**: 174行目 "マイページへ" ボタンが `/demo` にリンク
  - **正しい動作**: `/mypage` にリンクすべき
  - **現在**: `<a href="/demo" class="btn-glow text-xl px-12 py-4">`
  - **修正**: `<a href="/mypage" class="btn-glow text-xl px-12 py-4">`

- **問題**: 177行目 "ライブ配信を見る" ボタンが機能していない
  - **現在**: `<button class="btn-outline text-xl px-12 py-4">` (何もリンクされていない)
  - **修正案**: `/main` にリンクするか、機能が未実装なら削除

- **問題**: 184行目 "デモを見る" ボタンが機能していない
  - **現在**: `<button class="btn-outline text-xl px-12 py-4">` (何もリンクされていない)
  - **修正案**: `/demo` にリンクするか、削除

#### 2. **main.tsx**
- **問題**: 75-119行目 サンプルデータが固定表示
  - **日付**: "2026/01/28 15:00" (ハードコード)
  - **残り時間**: "残り 12分" (固定値)
  - **観戦者数**: "127人 観戦中" (固定値)
  - **必要な修正**: データベースから実際のデベート情報を取得して表示

- **問題**: 116行目 リンクURL形式が不正確
  - **現在**: `<a href="/watch/1">`
  - **正しい形式**: `/watch?id=xxx` または動的にデベートIDを取得

- **問題**: 52行目 "開発中プレビュー版" 表示
  - **現在**: `<span class="text-yellow-300 font-bold">開発中プレビュー版</span>`
  - **必要な判断**: 本番環境では削除すべきか？

#### 3. **demo.tsx**
- **問題**: 複数箇所に "開発中" の表示
  - 129行目: `<div class="progress-badge current">開発中</div>`
  - 146行目: `<h3 class="text-3xl font-bold mb-4 cyber-text">🎮 開発中プレビュー</h3>`
  - 148行目: "現在開発中のメインページをご覧いただけます"
  - 156行目: "※ 開発中のため、一部機能は動作しません"
  - **必要な判断**: このページを残すか削除するか？

### **中優先度 (Important)**

#### 4. **クレジット同期の問題**
- **報告されている問題**: クレジット同期で無限ループ/500エラー
- **調査が必要**: どのAPIエンドポイントで発生しているか特定
- **可能性のある原因**:
  - `/api/user/credits` エンドポイントの無限リクエスト
  - Cookie更新の競合
  - データベースクエリのエラー

#### 5. **アイコン同期の問題**
- **報告されている問題**: アイコンが正しく表示されない、ハンバーガーメニューと不一致
- **調査が必要**:
  - `avatar_url` の優先度ロジックが全ページで統一されているか
  - ハンバーガーメニューと他のページでアバター取得方法が異なるか

#### 6. **最終結果でのAI評価表示**
- **未実装機能**: デベート終了後にAI評価とスタンス情報を表示
- **現在の状態**: 勝敗結果のみ表示
- **必要な実装**:
  - AI judges の評価コメント表示
  - 各AIのスタンス（agree/disagree）を明示
  - 評価基準の可視化

#### 7. **最終投票後のAI投票記録**
- **未実装機能**: ユーザーの最終投票後にAIの投票も記録
- **必要な実装**:
  - AI judges の投票データをデータベースに保存
  - 投票統計に反映

### **低優先度 (Nice to have)**

#### 8. **UI改善**
- **三線アイコン**: ハンバーガーメニューアイコンのデザイン統一
- **不要要素**: 使用されていないボタンやプレースホルダーの削除

#### 9. **Tailwind CDN警告**
- **コンソール警告**: "Tailwind CDN should not be used in production"
- **解決方法**: PostCSS経由でTailwindをビルドに統合
- **影響**: 開発環境のみの警告、本番環境では問題なし

#### 10. **lockdown-install.js警告**
- **コンソール警告**: SES removing unpermitted intrinsics
- **影響**: セキュリティ強化の副作用、機能に影響なし

---

## ✅ 確認済み・問題なし

1. **SEO対策**: 全15ページに適切なメタタグ実装済み
2. **モバイル最適化**: viewport設定が全ページに存在
3. **データベーススキーマ**: 12マイグレーション、15テーブル正常動作
4. **アーカイブ購入API**: `archive_views`テーブル追加で500エラー解決済み
5. **デベート終了処理**: `/main`リダイレクト、コメント無効化実装済み

---

## 📋 確認が必要な事項（ユーザーに質問）

### **A. デモページの扱い**
- **Q1**: `/demo` ページは本番環境でも表示しますか？
- **Q2**: "開発中プレビュー" の表示は本番環境で削除しますか？

### **B. ホームページのボタン**
- **Q3**: "ライブ配信を見る" ボタンはどこにリンクすべきですか？（`/main` or 削除）
- **Q4**: "デモを見る" ボタンは `/demo` にリンクしますか？（or 削除）

### **C. メインページのデータ**
- **Q5**: サンプルデータは実際のデータベースから取得して表示に変更しますか？
- **Q6**: デベートがない場合の表示はどうしますか？（空状態のUI）

### **D. チケットシステム**
- **Q7**: チケットシステムのユーザー向けページを実装しますか？
- **Q8**: dev専用の管理画面を実装しますか？

### **E. AI評価機能**
- **Q9**: 最終結果でAI judges の評価コメントを表示しますか？
- **Q10**: AI judges の投票データもデータベースに保存しますか？

---

## 🚀 推奨される修正順序

### **フェーズ1: 即座に修正可能な項目 (30分)**
1. homepage.tsx の `/demo` → `/mypage` リンク修正
2. 不要なボタンの削除または正しいリンク設定
3. "開発中" 表示の削除（本番環境の場合）

### **フェーズ2: データ取得の実装 (1-2時間)**
4. main.tsx でデータベースからデベート情報を取得
5. クレジット同期エラーの原因調査と修正
6. アイコン同期の統一化

### **フェーズ3: 新機能実装 (2-3時間)**
7. AI評価表示機能の実装
8. AI投票記録機能の実装
9. チケットシステムの完成（必要な場合）

### **フェーズ4: 最終調整 (30分)**
10. UI改善とテスト
11. 最終ビルド・デプロイ

---

## 📝 メモ
- このレポートは2026-02-14時点の監査結果です
- 各項目の修正判断についてユーザーの確認が必要です
- 修正実施前にユーザーの意向を確認してください
